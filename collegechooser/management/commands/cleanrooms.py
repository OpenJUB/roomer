__author__ = 'twiesing'

from django.conf import settings
from django.core.management.base import BaseCommand
from django.core import management

import random
from collegechooser import utils

from roomer.models import Room

class Command(BaseCommand):
    help = 'Load rooms.csv and block rooms not in thhe csv'

    def handle(self, *args, **options):

        # HACK HACK HACK
        # Hard coded room sizes
        rooms = ["CA-108", "CA-208", "CA-308", "CB-108", "CD-208", "CB-308", "CC-108", "CC-208", "CC-308", "CD-108", "CD-208", "CD-308", "CA-101", "CA-102", "CA-103", "CA-109", "CA-112", "CA-113", "CA-116", "CA-117", "CA-120", "CA-121", "CA-124", "CA-125", "CA-128", "CA-129", "CA-132", "CA-133", "CA-136", "CA-137", "CA-201", "CA-202", "CA-209", "CA-212", "CA-213", "CA-216", "CA-217", "CA-220", "CA-221", "CA-224", "CA-225", "CA-228", "CA-229", "CA-232", "CA-233", "CA-236", "CA-237", "CA-240", "CA-241", "CA-301", "CA-302", "CA-309", "CA-312", "CA-313", "CA-316", "CA-317", "CA-320", "CA-321", "CA-324", "CA-325", "CA-328", "CA-329", "CA-332", "CA-333", "CA-336", "CA-337", "CA-340", "CA-341", "CB-101", "CB-102", "CB-103", "CB-109", "CB-112", "CB-113", "CB-116", "CB-117", "CB-120", "CB-121", "CB-124", "CB-125", "CB-128", "CB-129", "CB-132", "CB-133", "CB-136", "CB-137", "CB-201", "CB-202", "CB-209", "CB-212", "CB-213", "CB-216", "CB-217", "CB-220", "CB-221", "CD-224", "CB-225", "CB-228", "CB-229", "CB-232", "CB-233", "CB-236", "CB-237", "CB-240", "CB-241", "CB-301", "CB-302", "CB-309", "CB-312", "CB-313", "CB-316", "CB-317", "CB-320", "CB-321", "CB-324", "CB-325", "CB-328", "CB-329", "CB-332", "CB-333", "CB-336", "CB-337", "CB-340", "CB-341", "CC-101", "CC-106", "CC-109", "CC-112", "CC-113", "CC-116", "CC-117", "CC-120", "CC-121", "CC-124", "CC-125", "CC-128", "CC-129", "CC-132", "CC-133", "CC-136", "CC-137", "CC-209", "CC-212", "CC-213", "CC-216", "CC-217", "CC-220", "CC-221", "CC-224", "CC-225", "CC-228", "CC-229", "CC-232", "CC-233", "CC-236", "CC-237", "CC-309", "CC-312", "CC-313", "CC-316", "CC-317", "CC-320", "CC-321", "CC-324", "CC-325", "CC-328", "CC-329", "CC-332", "CC-333", "CC-336", "CC-337", "CC-340", "CC-341", "CD-101", "CD-109", "CD-112", "CD-113", "CD-116", "CD-117", "CD-120", "CD-121", "CD-124", "CD-125", "CD-128", "CD-129", "CD-132", "CD-133", "CD-136", "CD-137", "CD-209", "CD-212", "CD-213", "CD-216", "CD-217", "CD-220", "CD-221", "CD-224", "CD-225", "CD-228", "CD-229", "CD-232", "CD-233", "CD-236", "CD-237", "CD-240", "CD-241", "CD-309", "CD-312", "CD-313", "CD-316", "CD-317", "CD-320", "CD-321", "CD-324", "CD-325", "CD-328", "CD-329", "CD-332", "CD-333", "CD-336", "CD-337", "CE-202", "CE-205", "CE-208", "CE-211", "CE-214", "CE-217", "CE-220", "CE-223", "CE-302", "CE-305", "CE-308", "CE-311", "CE-314", "CE-317", "CE-320", "CE-323", "CE-401", "CE-402", "CE-405", "CE-406", "CE-410", "CE-413", "CE-416", "CE-419", "CE-422", "KA-108", "KA-137", "KA-208", "KA-308", "KB-108", "KB-137", "KB-208", "KB-308", "KC-108", "KC-137", "KC-208", "KC-308", "KA-101", "KA-102", "KA-103", "KA-109", "KA-112", "KA-113", "KA-116", "KA-117", "KA-120", "KA-121", "KA-124", "KA-125", "KA-128", "KA-129", "KA-132", "KA-133", "KA-136", "KA-202", "KA-203", "KA-209", "KA-212", "KA-213", "KA-216", "KA-217", "KA-220", "KA-221", "KA-224", "KA-225", "KA-228", "KA-229", "KA-232", "KA-233", "KA-236", "KA-237", "KA-240", "KA-241", "KA-309", "KA-312", "KA-313", "KA-316", "KA-317", "KA-320", "KA-321", "KA-324", "KA-325", "KA-328", "KA-329", "KA-332", "KA-333", "KA-336", "KA-337", "KA-340", "KA-341", "KB-101", "KB-102", "KB-103", "KB-109", "KB-112", "KB-113", "KB-116", "KB-117", "KB-120", "KB-121", "KB-124", "KB-125", "KB-128", "KB-129", "KB-132", "KB-133", "KB-136", "KB-209", "KB-212", "KB-213", "KB-216", "KB-217", "KB-220", "KB-221", "KB-224", "KB-225", "KB-228", "KB-229", "KB-232", "KB-233", "KB-236", "KB-237", "KB-240", "KB-241", "KB-302", "KB-303", "KB-309", "KB-112", "KB-313", "KB-316", "KB-317", "KB-320", "KB-321", "KB-324", "KB-325", "KB-328", "KB-329", "KB-332", "KB-333", "KB-336", "KB-337", "KB-340", "KB-341", "KC-109", "KC-112", "KC-113", "KC-116", "KC-117", "KC-120", "KC-121", "KC-124", "KC-125", "KC-128", "KC-129", "KC-132", "KC-133", "KC-136", "KC-202", "KC-203", "KC-209", "KC-212", "KC-213", "KC-216", "KC-217", "KC-220", "KC-221", "KC-224", "KC-225", "KC-228", "KC-229", "KC-232", "KC-233", "KC-236", "KC-237", "KC-240", "KC-241", "KC-302", "KC-303", "KC-309", "KC-312", "KC-313", "KC-316", "KC-317", "KC-320", "KC-321", "KC-324", "KC-325", "KC-328", "KC-329", "KC-332", "KC-333", "KC-336", "KC-337", "KC-340", "KC-341", "KD-201", "KD-203", "KD-205", "KD-207", "KD-209", "KD-211", "KD-213", "KD-215", "KD-217", "KD-301", "KD-303", "KD-305", "KD-307", "KD-309", "KD-311", "KD-313", "KD-315", "KD-317", "MA-108", "MA-137", "MA-208", "MA-308", "MB-108", "MB-137", "MB-208", "MB-308", "MC-108", "MC-137", "MC-208", "MC-308", "MA-109", "MA-112", "MA-113", "MA-116", "MA-117", "MA-120", "MA-121", "MA-124", "MA-125", "MA-128", "MA-129", "MA-132", "MA-133", "MA-136", "MA-202", "MA-203", "MA-209", "MA-212", "MA-213", "MA-216", "MA-217", "MA-220", "MA-221", "MA-224", "MA-225", "MA-228", "MA-229", "MA-232", "MA-233", "MA-236", "MA-237", "MA-240", "MA-241", "MA-302", "MA-303", "MA-309", "MA-312", "MA-313", "MA-316", "MA-317", "MA-320", "MA-321", "MA-324", "MA-325", "MA-328", "MA-329", "MA-332", "MA-333", "MA-336", "MA-337", "MA-340", "MA-341", "MB-101", "MB-102", "MB-103", "MB-109", "MB-112", "MB-113", "MB-116", "MB-117", "MB-120", "MB-121", "MB-124", "MB-125", "MB-128", "MB-129", "MB-132", "MB-133", "MB-136", "MB-209", "MB-212", "MB-213", "MB-216", "MB-217", "MB-220", "MB-221", "MB-224", "MB-225", "MB-228", "MB-229", "MB-232", "MB-233", "MB-236", "MB-237", "MB-240", "MB-241", "MB-302", "MB-303", "MB-309", "MB-312", "MB-313", "MB-316", "MB-317", "MB-320", "MB-321", "MB-324", "MB-325", "MB-328", "MB-329", "MB-332", "MB-333", "MB-336", "MB-337", "MB-340", "MB-341", "MC-101", "MC-102", "MC-103", "MC-109", "MC-112", "MC-113", "MC-116", "MC-117", "MC-120", "MC-121", "MC-124", "MC-125", "MC-128", "MC-129", "MC-132", "MC-133", "MC-136", "MC-202", "MC-203", "MC-209", "MC-212", "MC-213", "MC-216", "MC-217", "MC-220", "MC-221", "MC-224", "MC-225", "MC-228", "MC-229", "MC-232", "MC-233", "MC-236", "MC-237", "MC-240", "MC-241", "MC-309", "MC-312", "MC-313", "MC-316", "MC-317", "MC-320", "MC-321", "MC-324", "MC-325", "MC-328", "MC-329", "MC-332", "MC-333", "MC-336", "MC-337", "MC-340", "MC-341", "MD-201", "MD-203", "MD-205", "MD-207", "MD-209", "MD-211", "MD-213", "MD-215", "MD-217", "MD-301", "MD-303", "MD-305", "MD-307", "MD-309", "MD-311", "MD-313", "MD-315", "MD-317", "NB-178", "NB-180", "NB-181", "NB-184", "NB-185", "NB-188", "NB-189", "NB-192", "NB-193", "NB-196", "NB-197", "NB-278", "NB-280", "NB-281", "NB-284", "NB-285", "NB-288", "NB-289", "NB-292", "NB-293", "NB-296", "NB-297", "NB-378", "NB-380", "NB-381", "NB-384", "NB-385", "NB-388", "NB-389", "NB-392", "NB-393", "NB-396", "NB-397", "NB-478", "NB-480", "NB-481", "NB-484", "NB-485", "NB-488", "NB-489", "NB-492", "NB-493", "NB-496", "NB-497", "NC-208", "NC-210", "NC-211", "NC-308", "NC-310", "NC-311", "NC-408", "NC-410", "NC-411", "NA-201", "NA-203", "NA-205", "NA-207", "NA-209", "NA-211", "NA-213", "NA-215", "NA-217", "NA-219", "NA-221", "NA-223", "NA-225", "NA-227", "NA-229", "NA-231", "NA-233", "NA-235", "NA-301", "NA-303", "NA-305", "NA-307", "NA-309", "NA-311", "NA-313", "NA-315", "NA-317", "NA-319", "NA-321", "NA-323", "NA-325", "NA-327", "NA-329", "NA-331", "NA-333", "NA-335", "NA-401", "NA-403", "NA-405", "NA-407", "NA-409", "NA-411", "NA-413", "NA-415", "NA-417", "NA-419", "NA-421", "NA-423", "NA-425", "NA-427", "NA-429", "NA-431", "NA-433", "NA-435", "NA-507", "NA-509", "NA-511", "NA-513", "NA-515", "NA-517", "NA-519", "NA-521", "NA-523", "NA-525", "NA-527", "NA-529", "NA-531", "NA-533", "NA-535", "NB-102", "NB-103", "NB-106", "NB-107", "NB-110", "NB-111", "NB-114", "NB-115", "NB-118", "NB-119", "NB-122", "NB-124", "NB-126", "NB-127", "NB-130", "NB-131", "NB-134", "NB-135", "NB-146", "NB-147", "NB-150", "NB-151", "NB-162", "NB-163", "NB-166", "NB-167", "NB-170", "NB-171", "NB-174", "NB-175", "NB-202", "NB-203", "NB-206", "NB-207", "NB-210", "NB-211", "NB-214", "NB-215", "NB-218", "NB-219", "NB-222", "NB-224", "NB-226", "NB-227", "NB-230", "NB-231", "NB-234", "NB-235", "NB-238", "NB-239", "NB-246", "NB-247", "NB-250", "NB-251", "NB-262", "NB-263", "NB-266", "NB-267", "NB-270", "NB-271", "NB-274", "NB-275", "NB-302", "NB-303", "NB-306", "NB-307", "NB-310", "NB-311", "NB-314", "NB-315", "NB-318", "NB-319", "NB-322", "NB-324", "NB-326", "NB-327", "NB-330", "NB-331", "NB-334", "NB-335", "NB-338", "NB-339", "NB-346", "NB-347", "NB-350", "NB-351", "NB-362", "NB-363", "NB-366", "NB-367", "NB-370", "NB-371", "NB-374", "NB-375", "NB-402", "NB-403", "NB-406", "NB-407", "NB-410", "NB-411", "NB-414", "NB-415", "NB-418", "NB-419", "NB-422", "NB-424", "NB-426", "NB-427", "NB-430", "NB-431", "NB-434", "NB-435", "NB-438", "NB-439", "NB-462", "NB-463", "NB-466", "NB-467", "NB-470", "NB-471", "NB-474", "NB-475", "NC-203", "NC-216", "NC-218", "NC-219", "NC-222", "NC-224", "NC-303", "NC-316", "NC-318", "NC-319", "NC-416", "NC-418", "NC-419"]
        tallrooms = ["CA-108", "CA-208", "CA-308", "CB-108", "CD-208", "CB-308", "CC-108", "CC-208", "CC-308", "CD-108", "CD-208", "CD-308", "KA-108", "KA-137", "KA-208", "KA-308", "KB-108", "KB-137", "KB-208", "KB-308", "KC-108", "KC-137", "KC-208", "KC-308", "MA-108", "MA-137", "MA-208", "MA-308", "MB-108", "MB-137", "MB-208", "MB-308", "MC-108", "MC-137", "MC-208", "MC-308", "NB-178", "NB-180", "NB-181", "NB-184", "NB-185", "NB-188", "NB-189", "NB-192", "NB-193", "NB-196", "NB-197", "NB-278", "NB-280", "NB-281", "NB-284", "NB-285", "NB-288", "NB-289", "NB-292", "NB-293", "NB-296", "NB-297", "NB-378", "NB-380", "NB-381", "NB-384", "NB-385", "NB-388", "NB-389", "NB-392", "NB-393", "NB-396", "NB-397", "NB-478", "NB-480", "NB-481", "NB-484", "NB-485", "NB-488", "NB-489", "NB-492", "NB-493", "NB-496", "NB-497", "NC-208", "NC-210", "NC-211", "NC-308", "NC-310", "NC-311", "NC-408", "NC-410", "NC-411"]
        arooms = list(Room.objects.all())
        acodes = list(map(lambda r: r.code, arooms))

        for room in arooms:
            code = room.code
            
            # enable / disable rooms
            disabled = room.has_tag(Room.DISABLED_ROOM_TAG)            
            if not code in rooms:
                if not disabled:
                    print("Disabling {}".format(code))
                    room.add_tag(Room.DISABLED_ROOM_TAG)
                    room.save()
            else:
                if disabled:
                    print("Enabling {}".format(code))
                    room.remove_tag(Room.DISABLED_ROOM_TAG)
                    room.save()
            
            # make room tall / small
            tall = room.has_tag(Room.TALL_ROOM_TAG)
            if code in rooms and code in tallrooms:
                if not tall:
                    print("Talling {}".format(code))
                    #room.add_tag(Room.TALL_ROOM_TAG)
                    #room.save()
            else:
                if tall:
                    print("Smalling {}".format(code))
                    #room.remove_tag(Room.TALL_ROOM_TAG)
                    #room.save()


        for r in rooms:
            if not r in acodes:
                print("Missing room {}".format(r))